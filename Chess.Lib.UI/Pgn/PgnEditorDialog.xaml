<dialogs:DialogView x:Class="Chess.Lib.UI.Pgn.PgnEditorDialog"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Chess.Lib.UI.Pgn"
						 xmlns:dialogs="clr-namespace:Common.Lib.UI.Dialogs;assembly=Common.Lib.UI"
						 xmlns:pgn="clr-namespace:Chess.Lib.UI.Pgn"
						 xmlns:conv="clr-namespace:Common.Lib.UI.Converters;assembly=Common.Lib.UI"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800" Header="Export Game as PGN" DialogButtons="All" MinWidth="500">
	<dialogs:DialogView.Resources>
		<conv:ColonConverter x:Key="cconv"/>
		<DataTemplate x:Key="string">
			<TextBox Width="160" Text="{Binding Value}" BorderBrush="{Binding RequiredBorder}" BorderThickness="2"/>
		</DataTemplate>
		<DataTemplate x:Key="gameResult">
			<ComboBox Width="160" ItemsSource="{Binding GameResults}" SelectedItem="{Binding GameResult}"/>
		</DataTemplate>
		<DataTemplate x:Key="date">
			<DatePicker SelectedDate="{Binding EventDate}" SelectedDateFormat="Short" Width="160" VerticalAlignment="Center" VerticalContentAlignment="Center"
									Height="22"/>
		</DataTemplate>
		<pgn:PgnEditorTemplateSelector x:Key="pets" StringTemplate="{StaticResource string}"
																		 DateTemplate="{StaticResource date}" ResultTemplate="{StaticResource gameResult}"/>
	</dialogs:DialogView.Resources>
	<Grid>
		<Grid>
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto"/>
				<RowDefinition Height="Auto"/>
				<RowDefinition Height="Auto"/>
			</Grid.RowDefinitions>
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="260"/>
				<ColumnDefinition Width="320"/>
			</Grid.ColumnDefinitions>
			<ItemsControl Grid.Row="0" Grid.Column="0" ItemsSource="{Binding Tags}">
				<ItemsControl.ItemTemplate>
					<DataTemplate>
						<DockPanel>
							<Label Content="{Binding Tag,Converter={StaticResource cconv}}" Width="100" HorizontalAlignment="Right" HorizontalContentAlignment="Right"/>
							<ContentControl Content="{Binding}" ContentTemplateSelector="{StaticResource pets}" Width="160"/>
						</DockPanel>
					</DataTemplate>
				</ItemsControl.ItemTemplate>
			</ItemsControl>
			<GroupBox Header="Moves" Grid.Row="1" Grid.Column="0">
				<TextBox Text="{Binding Moves}" AcceptsReturn="True" AcceptsTab="True" IsReadOnly="{Binding CanEditMoves}"/>
			</GroupBox>
			<GroupBox Grid.Row="0" Grid.Column="1" Grid.RowSpan="2"  Header="Resulting PGN">
				<TextBox Style="{StaticResource multiLine}" Text="{Binding ResultingPGN,Mode=OneWay}" IsReadOnly="True"/>
			</GroupBox>
			<DockPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" LastChildFill="False">
				<Button DockPanel.Dock="Left" Content="Close" Command="{Binding Command}" CommandParameter="cancel" IsCancel="True"/>
				<Button DockPanel.Dock="Right" Content="Copy to Clipboard" Command="{Binding Command}" CommandParameter="ok" IsDefault="True"/>
			</DockPanel>
		</Grid>
	</Grid>
</dialogs:DialogView>
