<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:Chess.Lib.UI"
		xmlns:conv="clr-namespace:Common.Lib.UI.Converters;assembly=Common.Lib.UI"
		xmlns:lconv="clr-namespace:Chess.Lib.UI.Converters"
		xmlns:pgn="clr-namespace:Chess.Lib.UI.Pgn"
		xmlns:tkit="http://schemas.xceed.com/wpf/xaml/toolkit"
		xmlns:clock="clr-namespace:Chess.Lib.UI.Clock"
		xmlns:img="clr-namespace:Common.Lib.UI.Images;assembly=Common.Lib.UI"
		xmlns:ext="clr-namespace:Common.Lib.UI.Extensions;assembly=Common.Lib.UI"
	>
	<ResourceDictionary.MergedDictionaries>
		<ResourceDictionary Source="/Common.Lib.UI;component/CommonStyles.xaml"/>
	</ResourceDictionary.MergedDictionaries>
	<BooleanToVisibilityConverter x:Key="b2vc"/>
	<lconv:PieceToImageConverter x:Key="p2ic"/>
	<Style TargetType="{x:Type local:ChessBoard}">
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type local:ChessBoard}">
					<Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
						<AdornerDecorator Name="adorner">
							<Grid>
								<Grid Name="board"/>
							</Grid>
						</AdornerDecorator>
					</Border>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style TargetType="{x:Type local:ChessSquare}">
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type local:ChessSquare}">
					<Border Background="{TemplateBinding Background}">
						<Grid>
							<Image Name="piece"/>
							<TextBlock HorizontalAlignment="Left" VerticalAlignment="Bottom" FontSize="8" Foreground="Red"
												 Name="txt" Margin="2,0"/>
						</Grid>
					</Border>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style TargetType="{x:Type local:PlayerView}">
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type local:PlayerView}">
					<Grid Name="grid" DataContext="{x:Null}">
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto"/>
							<RowDefinition Height="Auto"/>
						</Grid.RowDefinitions>
						<Border BorderBrush="Black" BorderThickness="1" Grid.Row="{Binding NameRow}">
							<TextBlock Text="{Binding Name}" FontWeight="{Binding FontWeight}" Margin="2" TextWrapping="Wrap"/>
						</Border>
						<GroupBox Name="removed" Grid.Row="{Binding PiecesRow}" Header="Removed Pieces" Visibility="Collapsed">
							<ItemsControl ItemsSource="{Binding Pieces}">
								<ItemsControl.ItemTemplate>
									<DataTemplate>
										<Image Source="{Binding Converter={StaticResource p2ic}}" Width="14" Height="14"/>
									</DataTemplate>
								</ItemsControl.ItemTemplate>
								<ItemsControl.ItemsPanel>
									<ItemsPanelTemplate>
										<UniformGrid Columns="8"/>
									</ItemsPanelTemplate>
								</ItemsControl.ItemsPanel>
							</ItemsControl>
						</GroupBox>
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style TargetType="{x:Type local:MovesView}">
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type local:MovesView}">
					<Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}">
						<DataGrid Name="moves" IsReadOnly="True" AutoGenerateColumns="False" SelectionUnit="Cell" SelectionMode="Single">
							<DataGrid.Columns>
								<DataGridTextColumn Header="#" Binding="{Binding MoveNumber}"/>
								<DataGridTextColumn Header="White" Binding="{Binding WhiteMove.AlgebraicMove}"/>
								<DataGridTextColumn Header="Black" Binding="{Binding BlackMove.AlgebraicMove}"/>
							</DataGrid.Columns>
						</DataGrid>
					</Border>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style TargetType="{x:Type local:ChessGame}">
		<Style.Resources>
			<local:BoardDimensionConverter x:Key="brddim"/>
		</Style.Resources>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type local:ChessGame}">
					<Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}"
									Padding="{TemplateBinding Padding}">
						<Grid>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="Auto"/>
								<ColumnDefinition Width="*"/>
							</Grid.ColumnDefinitions>
							<DockPanel Grid.Column="0" Width="160" Margin="0,0,2,0">
								<local:PlayerView DockPanel.Dock="Top" Hue="Dark" Game="{TemplateBinding Game}"/>
								<local:PlayerView DockPanel.Dock="Bottom" Hue="Light" Game="{TemplateBinding Game}"/>
								<local:MovesView Game="{TemplateBinding Game}"/>
							</DockPanel>
							<local:ChessBoard Grid.Column="1" Game="{TemplateBinding Game}"
																Width="{Binding RelativeSource={RelativeSource TemplatedParent},Path=BoardDimension}" 
																Height="{Binding RelativeSource={RelativeSource TemplatedParent},Path=BoardDimension}" />
						</Grid>
					</Border>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style TargetType="{x:Type clock:ClockSettingsView}">
		<Style.Resources>
			<Style TargetType="{x:Type tkit:IntegerUpDown}">
				<Setter Property="Width" Value="50"/>
				<Setter Property="HorizontalAlignment" Value="Left"/>
			</Style>
		</Style.Resources>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type clock:ClockSettingsView}">
					<Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
						<Grid>
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto"/>
								<RowDefinition Height="Auto"/>
							</Grid.RowDefinitions>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="*"/>
								<ColumnDefinition Width="*"/>
							</Grid.ColumnDefinitions>
							<UniformGrid Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" Columns="3">
								<CheckBox Content="Enable Clock" IsChecked="{Binding UseClock}"/>
								<CheckBox Content="Use Dual Clock Settings" IsChecked="{Binding UseDual}" Margin="10,0" IsEnabled="{Binding UseClock}"/>
								<StackPanel Orientation="Horizontal">
									<Label Content="Presets:"/>
									<ComboBox ItemsSource="{Binding Presets}" SelectedItem="{Binding Preset}"/>
								</StackPanel>
							</UniformGrid>
							<GroupBox Grid.Row="1" Grid.Column="0" Header="{Binding SingleClockHeader}" IsEnabled="{Binding UseClock}">
								<Grid DataContext="{Binding SingleSettings}">
									<Grid.RowDefinitions>
										<RowDefinition Height="Auto"/>
										<RowDefinition Height="Auto"/>
									</Grid.RowDefinitions>
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="Auto"/>
										<ColumnDefinition Width="*"/>
									</Grid.ColumnDefinitions>
									<Label Grid.Row="0" Grid.Column="0" Content="Time Limit (min):"/>
									<tkit:IntegerUpDown Grid.Row="0" Grid.Column="1" Value="{Binding TimeLimit}" Minimum="1" Maximum="120" />
									<Label Grid.Row="1" Grid.Column="0" Content="Increment (s):"/>
									<tkit:IntegerUpDown Grid.Row="1" Grid.Column="1" Value="{Binding Increment}" Minimum="0" Maximum="10"/>
								</Grid>
							</GroupBox>
							<GroupBox Grid.Row="1" Grid.Column="1" Header="Black Clock" IsEnabled="{Binding UseDual}">
								<Grid DataContext="{Binding DualSettings}">
									<Grid.RowDefinitions>
										<RowDefinition Height="Auto"/>
										<RowDefinition Height="Auto"/>
									</Grid.RowDefinitions>
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="Auto"/>
										<ColumnDefinition Width="*"/>
									</Grid.ColumnDefinitions>
									<Label Grid.Row="0" Grid.Column="0" Content="Time Limit (min):"/>
									<tkit:IntegerUpDown Grid.Row="0" Grid.Column="1" Value="{Binding TimeLimit}" Minimum="1" Maximum="120" />
									<Label Grid.Row="1" Grid.Column="0" Content="Increment (s):"/>
									<tkit:IntegerUpDown Grid.Row="1" Grid.Column="1" Value="{Binding Increment}" Minimum="0" Maximum="10"/>
								</Grid>
							</GroupBox>
						</Grid>
					</Border>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style TargetType="{x:Type pgn:PgnTagEditor}">
		<Style.Resources>
			<conv:ColonConverter x:Key="cconv"/>
			<DataTemplate x:Key="string">
				<DockPanel Width="150">
					<Button DockPanel.Dock="Right" Style="{x:Null}" Width="16" Height="16" Command="{Binding DelCommand}" CommandParameter="{Binding}">
						<Image img:ImageProvider.ImageType="Delete"/>
					</Button>
					<TextBox Text="{Binding Value}" BorderThickness="2" ext:TextBoxEx.SelectAllOnFocus="True" ext:TextBoxEx.UpdateBindingOnEnter="True"/>
				</DockPanel>
			</DataTemplate>
			<DataTemplate x:Key="reqString">
				<TextBox Width="150" Text="{Binding Value}" BorderBrush="{Binding RequiredBorder}" BorderThickness="2"
							 ext:TextBoxEx.SelectAllOnFocus="True" ext:TextBoxEx.UpdateBindingOnEnter="True"/>
			</DataTemplate>
			<DataTemplate x:Key="gameResult">
				<ComboBox Width="160" ItemsSource="{Binding GameResults}" SelectedItem="{Binding GameResult}"/>
			</DataTemplate>
			<DataTemplate x:Key="date">
				<DatePicker SelectedDate="{Binding EventDate}" SelectedDateFormat="Short" Width="150" VerticalAlignment="Center" VerticalContentAlignment="Center"
									Height="26"/>
			</DataTemplate>
			<pgn:TagEditorTemplateSelector  x:Key="tets" StringTemplate="{StaticResource string}" ReqStringTemplate="{StaticResource reqString}"
																		 DateTemplate="{StaticResource date}" ResultTemplate="{StaticResource gameResult}"/>
		</Style.Resources>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type pgn:PgnTagEditor}">
					<Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
						<Grid>
							<Grid.RowDefinitions>
								<RowDefinition Height="*"/>
								<RowDefinition Height="Auto"/>
							</Grid.RowDefinitions>
							<ScrollViewer Grid.Row="0" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Auto">
								<ItemsControl ItemsSource="{Binding Tags}" MaxHeight="440">
									<ItemsControl.ItemTemplate>
										<DataTemplate>
											<DockPanel>
												<Label Content="{Binding Tag,Converter={StaticResource cconv}}" FontWeight="{Binding TagWeight}"
													 Width="100" HorizontalAlignment="Right" HorizontalContentAlignment="Right" IsTabStop="False"/>
												<ContentControl Content="{Binding}" ContentTemplateSelector="{StaticResource tets}" Width="150"/>
											</DockPanel>
										</DataTemplate>
									</ItemsControl.ItemTemplate>
								</ItemsControl>
							</ScrollViewer>
							<DockPanel Grid.Row="1" LastChildFill="False">
								<Button Content="Add Tag" Command="{Binding Command}" CommandParameter="addTag"/>
								<StackPanel Orientation="Horizontal" DockPanel.Dock="Left" Visibility="{Binding IsAddingTag,Converter={StaticResource b2vc}}">
									<Label Content="Tag Name:"/>
									<TextBox Width="160" Text="{Binding NewTag}" HorizontalAlignment="Left" ext:TextBoxEx.UpdateBindingOnEnter="True"
									 Name="newTag" ToolTip="Press &lt;Enter&gt; to add tag"/>
								</StackPanel>
							</DockPanel>
						</Grid>
					</Border>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
</ResourceDictionary>
